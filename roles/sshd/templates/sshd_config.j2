# ============================================================ #
# Auto-generated by Ansible                                    #
# Do not edit manually! Changes will be overwritten.           #
# ============================================================ #

{# Включение конфигов из директории #}
Include /etc/ssh/sshd_config.d/*.conf

{# Базовые настройки #}
Port {{ sshd_config.port }}

HostKey /etc/ssh/ssh_host_rsa_key
HostKey /etc/ssh/ssh_host_ecdsa_key
HostKey /etc/ssh/ssh_host_ed25519_key

{# Настройки логирования #}
SyslogFacility AUTH
LogLevel {{ sshd_config.log_level }}

{# Настройки аутентификации #}
LoginGraceTime {{ sshd_config.login_grace_time }}
PermitRootLogin {{ sshd_config.permit_root_login }}
StrictModes {{ sshd_config.strict_mode }}
MaxAuthTries {{ sshd_config.max_auth_tries }}
MaxSessions {{ sshd_config.max_sessions }}

{# Настройки публичного ключа #}
PubkeyAuthentication {{ sshd_config.pubkey_authentication }}
AuthorizedKeysFile .ssh/authorized_keys .ssh/authorized_keys2

{# Настройки парольной аутентификации #}
PasswordAuthentication {{ sshd_config.password_authentication }}
PermitEmptyPasswords no
ChallengeResponseAuthentication no
KbdInteractiveAuthentication {{ sshd_config.interactive_authentication }}

{# Методы аутентификации #}
AuthenticationMethods {{ sshd_config.authentication_methods }}

{# Настройки безопасности #}
UsePAM {{ sshd_config.use_pam }}
AllowTcpForwarding {{ sshd_config.allow_tcp_forwarding }}
AllowAgentForwarding {{ sshd_config.allow_agent_forwarding }}
X11Forwarding {{ sshd_config.x11_forwarding }}
PrintMotd no
PrintLastLog {{ sshd_config.print_last_log }}
TCPKeepAlive {{ sshd_config.tcp_keep_alive }}

{# Настройки keepalive #}
ClientAliveInterval {{ sshd_config.client_alive_interval }}
ClientAliveCountMax {{ sshd_config.client_alive_count_max }}

{# Настройки лимитов #}
MaxStartups {{ sshd_config.max_startups }}

{# Переменные окружения #}
AcceptEnv LANG LC_*

{# Подсистема SFTP #}
Subsystem sftp /usr/lib/openssh/sftp-server
